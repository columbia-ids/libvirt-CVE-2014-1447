libvirt_version = 0.9.8
build_dir = libvirt-$(libvirt_version)
install_dir = $(HOME)/libvirt

build : $(install_dir)/sbin/libvirtd

$(install_dir)/sbin/libvirtd : $(build_dir)/Makefile
	cd $(build_dir); CFLAGS="-g -O0"; \
		./configure --without-udev --prefix=$(install_dir)
	make -C $(build_dir)
	make -C $(build_dir) install

$(build_dir)/Makefile : libvirt-$(libvirt_version).tar.gz
	tar xvf libvirt-$(libvirt_version).tar.gz

.PHONY : build libvirtd clean

libvirtd : build
	$(install_dir)/sbin/libvirtd &

clean :
	rm -vrf $(build_dir) $(install_dir)
